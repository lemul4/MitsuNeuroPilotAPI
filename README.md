# Разработка интеллектуального агента автопилота на основе нейросетевых технологий в среде симуляции автономного вождения

## Цель проекта
Разработка интеллектуального агента для автономного управления автомобилем в условиях реального дорожного движения. Система обеспечивает:

- Безопасное передвижение без участия водителя
- Анализ дорожной ситуации (другие участники движения, состояние дорожного покрытия, погодные условия)
- Распознавание объектов, дорожных знаков и разметки
- Прогнозирование изменений дорожной обстановки
- Реакцию в реальном времени с использованием:
  - Машинного обучения
  - Компьютерного зрения
  - Обработки данных с датчиков

## Установка

1. Установите Python 3.10 и CARLA (рекомендуется версия 0.9.15).
2. Установите зависимости:
    ```bash
    python -m venv .venv
     ```
    ```bash
    .\.venv\Scripts\activate.bat    # Windows
     ```
    ```bash
    pip install -r requirements.txt
    ```

## Запуск агента с нейросетью

1. Запустите CARLA (`CarlaUE4.exe`).
2. Перейдите в папку `use_cases/evaluation`.
3. Откройте файл `run_evaluator.ps1`.
4. Замените значение переменной `TEAM_AGENT` на:

    ```
    adapters\\agents\\agents\\imitation_service.agent.py
    ```

5. Запустите PowerShell в этой папке и выполните:

    ```powershell
    ./run_evaluator.ps1
    ```

Агент начнет проходить заданные сценарии в симуляции CARLA, управляя автомобилем с помощью нейросетевой модели.

## Сбор данных для обучения

1. Запустите CARLA (`CarlaUE4.exe`).
2. Перейдите в папку `use_cases/evaluation`.
3. Откройте файл `run_evaluator.ps1`.
4. Замените значение переменной `TEAM_AGENT` на:

    ```
    adapters\\agents\\agents\\autopilot_service.agent.py
    ```

5. В PowerShell выполните:

    ```powershell
    ./run_evaluator.ps1
    ```

Во время проезда агента все данные (изображения, управляющие действия и т.д.) будут сохраняться в папку `dataset`.

## Запуск FastAPI микросервиса с агентом

1. Перейдите в директорию:

    ```
    adapters/agents/agents/autopilot_microservice
    ```

2. Запустите FastAPI-сервис:

    ```bash
    python -m autopilot_service
    ```

3. Откройте в браузере:

    ```
    http://localhost:8002/docs
    ```
